#include "mainwindow.h"
#include "ui_mainwindow.h"

/*
 * REFACTOR ALL FILES WHEN YOU'RE DONE AND BEFORE SUBMITTING IT TO CODEWARS
 *
 * if you can get around using some of operator overloaded functions, do so
 *
 * add a sort and std::unique bit to filter out duplicated circles, then replace c == *node.circle to &c == node.circle
 *
 * if a node-path leads to a dead end, de-emphasize the lines of that graph (or remove them if you want but i wouldn't do that tbh)
 *
 * find a way to pause the running of the code between and within tests so we can see the order and manner in which the algorithm searches
 * dynamic moving of start, end and circles during test like on that website?
 */

MainWindow::MainWindow(QWidget *parent)
    : QMainWindow(parent)
    , ui(new Ui::MainWindow)
{
    ui->setupUi(this);

    scene = new QGraphicsScene(this);
    view = new QGraphicsView(this);
    view->setRenderHint(QPainter::Antialiasing);

    view->show();
    view->setFocus();
    setCentralWidget(view);

    path_pen.setColor(Qt::green); path_pen.setWidth(3);
    answer_pen.setColor(Qt::red); answer_pen.setWidth(4);
    axes_pen.setColor(Qt::black); axes_pen.setWidth(3);
    circle_colour = Qt::yellow;
    point_colour = Qt::gray;
    start_colour = Qt::white;
    end_colour = Qt::black;
    scale = 100;

    do_tests();
}
MainWindow::~MainWindow()
{
    delete ui;
}

void MainWindow::add_line(const Point& p1, const Point& p2, QPen _pen = QPen()) {
    scene->addLine(QLineF(scale * p1.x, scale * -p1.y, scale * p2.x, scale * -p2.y), _pen);
}
void MainWindow::add_line(const Node& n1, const Node& n2, QPen _pen = QPen()) {
    add_line(n1.pos, n2.pos, _pen);
}
void MainWindow::add_arc(const Node& n1, const Node& n2, QPen _pen = QPen()) {
    const Circle& c = *n1.circle;
    double alpha = arg(n1.pos - n1.circle->ctr), beta = arg(n2.pos - n1.circle->ctr);
    std::vector<AnglePair> ranges = (n1.cw)
            ? (alpha >= beta) ? std::vector<AnglePair>{{beta, alpha}} : std::vector<AnglePair>{{beta, 2*M_PI}, {-1e-16, alpha}}
            : (beta >= alpha) ? std::vector<AnglePair>{{alpha, beta}} : std::vector<AnglePair>{{alpha, 2*M_PI}, {-1e-16, beta}};
    for (auto [start_angle, end_angle] : ranges) {
        QGraphicsEllipseItem* item = new QGraphicsEllipseItem(QRectF(scale * (c.ctr.x - c.r), scale * (-c.ctr.y - c.r), scale * c.r * 2, scale * c.r * 2));
        start_angle *= 16 * 360/(2*M_PI);
        end_angle *= 16 * 360/(2*M_PI);
        item->setStartAngle(start_angle);
        item->setSpanAngle(end_angle - start_angle);
        item->setPen(_pen);
        scene->addItem(item);
    }
}

void MainWindow::add_circle(const Point& ctr, double r, QColor colour = Qt::white) {
    scene->addEllipse(QRectF(scale * (ctr.x - r), scale * (-ctr.y - r), scale * r * 2, scale * r * 2), QPen(), QBrush(colour));
}

void MainWindow::set_up_grid_lines(double min_x, double max_x, double min_y, double max_y, int padding = 1)
{
    min_x -= padding, max_x += padding;
    min_y -= padding, max_y += padding;
    for (int i = min_x; i <= max_x; ++i)
        add_line({(double)i, min_y}, {(double)i, max_y});
    for (int i = min_y; i <= max_y; ++i)
        add_line({min_x, (double)i}, {max_x, (double)i});
    add_line({min_x, 0}, {max_x, 0}, axes_pen);
    add_line({0, min_y}, {0, max_y}, axes_pen);
}

void MainWindow::display_test(const Point& start, const Point& end, const std::vector<Circle>& circles)
{
   int min_x = std::min({0.0, start.x, end.x})-1, max_x = std::max({0.0, start.x, end.x})+1,
       min_y = std::min({0.0, start.y, end.y})-1, max_y = std::max({0.0, start.y, end.y})+1;
   for (const Circle& c : circles) {
       min_x = std::min(min_x, int(std::floor(c.ctr.x - c.r))), max_x = std::max(max_x, int(std::ceil(c.ctr.x + c.r)));
       min_y = std::min(min_y, int(std::floor(c.ctr.y - c.r))), max_y = std::max(max_y,  int(std::ceil(c.ctr.y + c.r)));
       add_circle(c.ctr, c.r, circle_colour);
   }
   add_circle(start, 0.1, start_colour);
   add_circle(end, 0.1, end_colour);
   set_up_grid_lines(min_x, max_x, min_y, max_y);
   view->setScene(scene);
}

void MainWindow::display_answer(const Node& end_node)
{
    for (const Node* p = &end_node; p->prev != nullptr; p = p->prev) {
        add_line(*p->prev, *p, answer_pen);
        p = p->prev;
        add_arc(*p->prev, *p, answer_pen);
    }
}

double MainWindow::shortest_path_length(const Point& start, const Point& end, std::vector<Circle> circles, bool debug = false, bool display = true)
{
    auto point_is_valid = [&](const Point& p){
        return std::all_of(circles.begin(), circles.end(), [&](const Circle& c) {
            return dist(p, c.ctr) >= c.r;
        });
    };
    auto line_is_valid = [&](const Point& p1, const Point& p2, const Circle& c1, const Circle& c2) {
        if (p1 == p2) return true;
        double a  = p2.x - p1.x, b = p2.y - p1.y;
        return std::all_of(circles.begin(), circles.end(), [&](const Circle& circle){
            for (const Circle& c_ : {c1, c2}) if (c_ == circle) return true; // &c_ shouldn't equal nullptr
            double c = circle.ctr.x - p1.x, d = circle.ctr.y - p1.y, k = (a*c + b*d) / (a*a + b*b);
            return (0 <= k && k <= 1)
                    ? std::abs(a*d - b*c) / std::sqrt(a*a + b*b) >= circle.r
                    : std::min(dist(p1, circle.ctr), dist(p2, circle.ctr)) >= circle.r;
        });
    };
    auto arc_is_valid = [&](const Node& n1, const Node& n2) {
        double alpha = arg(n1.pos - n1.circle->ctr), beta = arg(n2.pos - n1.circle->ctr);
        if (alpha == beta) return true;
        std::vector<AnglePair> ranges = (n1.cw)
                ? (alpha > beta) ? std::vector<AnglePair>{{beta, alpha}} : std::vector<AnglePair>{{beta, 2*M_PI}, {-std::numeric_limits<double>::epsilon(), alpha}}
                : (beta > alpha) ? std::vector<AnglePair>{{alpha, beta}} : std::vector<AnglePair>{{alpha, 2*M_PI}, {-std::numeric_limits<double>::epsilon(), beta}};
        for (const Circle& c : circles) {
            if (c == *n1.circle) continue;
            double d = dist(n1.circle->ctr, c.ctr), r = n1.circle->r;
            if (d <= std::abs(r - c.r) || d >= r + c.r) continue;
            double theta = arg(c.ctr - n1.circle->ctr), phi = std::acos((r*r + d*d - c.r*c.r) / (2*r*d));
            for (double angle : {theta + phi, theta - phi}) {
                angle = std::fmod(angle + 2*M_PI, 2*M_PI);
                for (const auto& [start_angle, end_angle] : ranges)
                    if (start_angle < angle && angle < end_angle) return false;
            }
        }
        return true;
    };

    if (display) scene->clear(); // to be removed
    if (display) display_test(start, end, circles); // to be removed
    if (!point_is_valid(start) || !point_is_valid(end)) return -1.0;
    std::list<Node> visited_nodes;
    std::priority_queue<Node, std::vector<Node>, CompareHeuristic> queue;
    Circle start_circle(start, 0), end_circle(end, 0);
    Node start_node {start, 0, dist(start, end), 1, &start_circle, nullptr};
    circles.push_back(end_circle); queue.push(start_node);
    std::map<std::pair<Circle *, int>, std::vector<Path>> paths_from_circles;

    auto find_next_nodes = [&](const Node& node) {
        std::vector<Path> paths;
        std::pair<Circle *, int> key = {const_cast<Circle *>(node.circle), node.cw};
        auto it = paths_from_circles.find(key);
        if (it == paths_from_circles.end()) {
            for (const Circle& c : circles) {
                if (c == *node.circle) continue;
                double d = dist(node.circle->ctr, c.ctr), theta = arg(c.ctr - node.circle->ctr), r = node.circle->r;
                std::vector<std::pair<AnglePair, bool>> angle_pairs;
                if (r + c.r <= d) { // find internal bitangents and tangents(where circles touch)
                    double alpha = std::acos((r + c.r) / d);
                    if (node.cw) angle_pairs.push_back({{theta + alpha, theta + alpha + M_PI}, true});
                    if (!node.cw || (r == 0 && c.r != 0)) angle_pairs.push_back({{theta - alpha, theta - alpha + M_PI}, (r != 0)});
                }
                if (r != 0 && std::abs(r - c.r) < d) { // find external bitangents
                    double beta = std::acos((r - c.r) / d);
                    if (node.cw) angle_pairs.push_back({{theta + beta, theta + beta}, false});
                    else angle_pairs.push_back({{theta - beta, theta - beta}, false});
                }
                for (const auto& [angle_pair, changesRotation] : angle_pairs) { // if the line is valid, add it to paths
                    auto [angle1, angle2] = angle_pair;
                    Point start_pos = node.circle->ctr + Point(r * std::cos(angle1), r * std::sin(angle1)),
                          end_pos = c.ctr + Point(c.r * std::cos(angle2), c.r * std::sin(angle2));
                    if (line_is_valid(start_pos, end_pos, *node.circle, c))
                        paths.push_back({start_pos, end_pos, dist(start_pos, end_pos), dist(end_pos, end),
                                        &c, node.cw, (node.cw ^ changesRotation), std::numeric_limits<double>::max()});
                }
            }
            paths_from_circles.insert({key, std::move(paths)});
            it = paths_from_circles.find(key);
        }

        std::vector<Node> nodes;
        for (Path& path : it->second) { // if the arc from node.pos to path.start_pos is valid, add it to nodes
            double phi = (node.circle->r == 0) ? 0.0 : arg(path.start_pos - node.circle->ctr) - arg(node.pos - node.circle->ctr);
            if (phi < 0) phi += 2*M_PI; if (node.cw && phi != 0) phi = 2*M_PI - phi;
            double arc_length = phi * node.circle->r;
            Node n1 {path.start_pos, node.running_length + arc_length, node.running_length + arc_length + dist(path.start_pos, end), -1, node.circle, &node},
                 n2 {path.end_pos, n1.running_length + path.length, n1.running_length + path.length + path.dist_to_end, path.end_cw, path.end_circle, nullptr};
            if (n1.running_length < path.shortest_incoming_dist && arc_is_valid(node, n1)) {
                visited_nodes.push_back(n1);
                n2.prev = &visited_nodes.back(); nodes.push_back(n2);
                path.shortest_incoming_dist = n1.running_length; // may need to be changed since branches with a smaller length but a higher heuristic may be rejected when they have potential
            }
        }
        return nodes;
    };

    while (!queue.empty()) {
        // if (debug) { qDebug() << "queue:"; printQueue(queue); qDebug(); }
        visited_nodes.push_back(queue.top());
        const Node& node = visited_nodes.back();
        if (debug) qDebug() << "current node:" << node;
        if (node.pos == end) {
            if (display) display_answer(node);
            return node.running_length;
        }
        queue.pop();
        auto new_nodes = find_next_nodes(node);
        for (const Node& n : new_nodes) {
            if (display && node.prev != nullptr) add_arc(*n.prev->prev, *n.prev, path_pen); // why node.prev and not node.prev->prev ???
            if (display) add_circle(n.prev->pos, 0.05, point_colour);
            if (display) add_line(*n.prev, n, path_pen);
            if (display) add_circle(n.pos, 0.05, point_colour);
            // if (debug) qDebug() << "\tconnected to" << n.pos << "on" << *n.circle << "|" << n.heuristic << "|" << << n.cw;
            queue.push(n);
        }
    }
    return -1.0; // ggs
}

void MainWindow::do_test(const Point& a, const Point& b, const std::vector<Circle>& c, double ans, bool debug = false, bool display = true)
{
    const double max_error = 1e-8;
    double actual = shortest_path_length(a, b, c, debug, display);
    qDebug() << Qt::fixed << qSetRealNumberPrecision(12) << "actual:" <<  actual << ", ans:" << ans;
    if(EqualsWithDelta(actual, ans, max_error))
      qDebug() << "Passed\n";
    else
      qDebug() << "Failed\n";
}

void MainWindow::do_tests()
{
    Point a,b;
    std::vector<Circle> c;

    QElapsedTimer timer;
    timer.start();

    qDebug() << "-------------- Short Tests --------------\n";

    a = {-3, 1};   b = {4.25, 0};
    c = { {0.0, 0.0, 2.5}, {1.5, 2.0, 0.5}, {3.5, 1.0, 1.0}, {3.5, -1.7, 1.2} };
    do_test(a, b, c, 9.11821650244);

    a = {-2.5, 3.0};   b = {-2.5, -5};
    c = { {-3.5, 0.0, 1.0}, {0.0, 0.0, 2.5}, {1.5, 2.0, 0.5}, {3.5, 1.0, 1.0}, {3.5, -1.7, 1.2} };
    do_test(a, b, c, 8.0);
    a = {3, 0};   b = {0, 4};
    c = { {0, 0, 1} };
    do_test(a, b, c, 5.0);

    a = {0, 0};  b = {20, 20};
    c = { {4, 0, 3}, {-4, 0, 3}, {0, 4, 3}, {0, -4, 3} };
    do_test(a, b, c, -1.0);

    a = {0, 1};  b = {0, -1};
    c = { {0.0, 0.0, 0.8}, {-3.8, 0.0, 3.2}, {3.5, 0.0, 3.0}, {7.0, 0.0, 1.0} };
    do_test(a, b, c, 19.0575347577);

    a = {0, -7};  b = {8, 8};
    c = { };
    do_test(a, b, c, 17.0);

    a = {-3.5, 0.1};  b = {3.5, 0.0};
    double r = 2.01;
    c = { {0,0,1}, {r, 0.0, 1.0}, {r*0.5, r*sqrt(3)/2, 1.0}, {-r*0.5, r*sqrt(3)/2, 1.0},
                    {-r, 0.0, 1.0}, {r*0.5, -r*sqrt(3)/2, 1.0}, {-r*0.5, -r*sqrt(3)/2, 1.0} };
    do_test(a, b, c, 7.80758072818);

    // start in forbidden zone:
    a = {0.5, 0.5};  b = {2, 2};
    c = { {0, 0, 1} };
    do_test(a, b, c, -1.0);

    // end in forbidden zone:
    a = {2, 2};  b = {0.5, 0.5};
    c = { {0, 0, 1} };
    do_test(a, b, c, -1.0);

    qDebug() << "-------------------- Long Tests --------------------\n";

    a = { 1.000, 1.000 };
    b = { 9.000, 9.000 };
    c = {
    { 0.000, 0.000, 0.1628746463684365 },
    { 0.000, 1.000, 0.3523985967272892 },
    { 0.000, 2.000, 0.5364255122607574 },
    { 0.000, 3.000, 0.4300622401060537 },
    { 0.000, 4.000, 0.3106004946632311 },
    { 0.000, 5.000, 0.5266889514634385 },
    { 0.000, 6.000, 0.5684803681215271 },
    { 0.000, 7.000, 0.5833063065307215 },
    { 0.000, 8.000, 0.1994006278691813 },
    { 0.000, 9.000, 0.1901628721738234 },
    { 0.000, 10.000, 0.4963121007895097 },
    { 1.000, 0.000, 0.7945029408903792 },
    { 1.000, 2.000, 0.2510755163384601 },
    { 1.000, 3.000, 0.7169563776114956 },
    { 1.000, 4.000, 0.5250582014909014 },
    { 1.000, 5.000, 0.1930718991206959 },
    { 1.000, 6.000, 0.4261120012728497 },
    { 1.000, 7.000, 0.2375767939025536 },
    { 1.000, 8.000, 0.5907849639421329 },
    { 1.000, 9.000, 0.3803132777335122 },
    { 1.000, 10.000, 0.4899552673799917 },
    { 2.000, 0.000, 0.5319813678273931 },
    { 2.000, 1.000, 0.3844743007561192 },
    { 2.000, 2.000, 0.2923103458480910 },
    { 2.000, 3.000, 0.3923667530296370 },
    { 2.000, 4.000, 0.5005855676019564 },
    { 2.000, 5.000, 0.6281589973485097 },
    { 2.000, 6.000, 0.4360745647223666 },
    { 2.000, 7.000, 0.6754929979098960 },
    { 2.000, 8.000, 0.3913260711589828 },
    { 2.000, 9.000, 0.4938314033439383 },
    { 2.000, 10.000, 0.2520577947841957 },
    { 3.000, 0.000, 0.5762704281834885 },
    { 3.000, 1.000, 0.3109034419292584 },
    { 3.000, 2.000, 0.6057505614822730 },
    { 3.000, 3.000, 0.4061566901626065 },
    { 3.000, 4.000, 0.6387910791439936 },
    { 3.000, 5.000, 0.3983294921228662 },
    { 3.000, 6.000, 0.5167727740248665 },
    { 3.000, 7.000, 0.3643342807190493 },
    { 3.000, 8.000, 0.3022542553720995 },
    { 3.000, 9.000, 0.5889043335104361 },
    { 3.000, 10.000, 0.6993306066608056 },
    { 4.000, 0.000, 0.6529837415786460 },
    { 4.000, 1.000, 0.5801291283918545 },
    { 4.000, 2.000, 0.1467481157043949 },
    { 4.000, 3.000, 0.6416853299131616 },
    { 4.000, 4.000, 0.1581593501614407 },
    { 4.000, 5.000, 0.4961532718269154 },
    { 4.000, 6.000, 0.2940124519402161 },
    { 4.000, 7.000, 0.6900777980452403 },
    { 4.000, 8.000, 0.5667996307136490 },
    { 4.000, 9.000, 0.3927921340567991 },
    { 4.000, 10.000, 0.5148965323576703 },
    { 5.000, 0.000, 0.1274027654668316 },
    { 5.000, 1.000, 0.5030676863389090 },
    { 5.000, 2.000, 0.4777844483731314 },
    { 5.000, 3.000, 0.2625929247820750 },
    { 5.000, 4.000, 0.3290316406404599 },
    { 5.000, 5.000, 0.4629337185295299 },
    { 5.000, 6.000, 0.5243985806358978 },
    { 5.000, 7.000, 0.5472880630055442 },
    { 5.000, 8.000, 0.3864086774876341 },
    { 5.000, 9.000, 0.2001247341977432 },
    { 5.000, 10.000, 0.4910248144296929 },
    { 6.000, 0.000, 0.3333424225682393 },
    { 6.000, 1.000, 0.3390456042950973 },
    { 6.000, 2.000, 0.3665664402069524 },
    { 6.000, 3.000, 0.4757285737199708 },
    { 6.000, 4.000, 0.8237753840396180 },
    { 6.000, 5.000, 0.6055396901210770 },
    { 6.000, 6.000, 0.8604423254029825 },
    { 6.000, 7.000, 0.3713895830092951 },
    { 6.000, 8.000, 0.5601797837996855 },
    { 6.000, 9.000, 0.7542402487015352 },
    { 6.000, 10.000, 0.4849949301453307 },
    { 7.000, 0.000, 0.3370519649935886 },
    { 7.000, 1.000, 0.4161911523202434 },
    { 7.000, 2.000, 0.6041885798564181 },
    { 7.000, 3.000, 0.2711943033384159 },
    { 7.000, 4.000, 0.6511102757183834 },
    { 7.000, 5.000, 0.5126366399461403 },
    { 7.000, 6.000, 0.7969563483959063 },
    { 7.000, 7.000, 0.6673986469628289 },
    { 7.000, 8.000, 0.5619564772350714 },
    { 7.000, 9.000, 0.3324886301765218 },
    { 7.000, 10.000, 0.7300074005266651 },
    { 8.000, 0.000, 0.6491321481065825 },
    { 8.000, 1.000, 0.4017128477571532 },
    { 8.000, 2.000, 0.2637480404460802 },
    { 8.000, 3.000, 0.5922080177580937 },
    { 8.000, 4.000, 0.3521049984963611 },
    { 8.000, 5.000, 0.2786758293164894 },
    { 8.000, 6.000, 0.5483823104063049 },
    { 8.000, 7.000, 0.5921106083085760 },
    { 8.000, 8.000, 0.2816006015287712 },
    { 8.000, 9.000, 0.5140958129195496 },
    { 8.000, 10.000, 0.6654430777067318 },
    { 9.000, 0.000, 0.2196358360117301 },
    { 9.000, 1.000, 0.5013549668015912 },
    { 9.000, 2.000, 0.4389178612036631 },
    { 9.000, 3.000, 0.5264885412761942 },
    { 9.000, 4.000, 0.5317781867226585 },
    { 9.000, 5.000, 0.3550532921450212 },
    { 9.000, 6.000, 0.4161083685932681 },
    { 9.000, 7.000, 0.2114355121040717 },
    { 9.000, 8.000, 0.6029599722241983 },
    { 9.000, 10.000, 0.6235687331529334 },
    { 10.000, 0.000, 0.4041926589561626 },
    { 10.000, 1.000, 0.5229661515215411 },
    { 10.000, 2.000, 0.4306587716331705 },
    { 10.000, 3.000, 0.5710683602141217 },
    { 10.000, 4.000, 0.5276285207597539 },
    { 10.000, 5.000, 0.4876143969828263 },
    { 10.000, 6.000, 0.2369333103066310 },
    { 10.000, 7.000, 0.4831113030435517 },
    { 10.000, 8.000, 0.5696406797273085 },
    { 10.000, 9.000, 0.6816570753464475 },
    { 10.000, 10.000, 0.3564727762481197 },
    };
    do_test(a, b, c, 13.5171175305898110, false, false);

    a = { 1.000, 1.000 };
    b = { 9.000, 9.000 };
    c = {
    { 0.000, 0.000, 0.3498640827136114 },
    { 0.000, 1.000, 0.5531412089942023 },
    { 0.000, 2.000, 0.7099347036564723 },
    { 0.000, 3.000, 0.6517945740139112 },
    { 0.000, 4.000, 0.1975581311853603 },
    { 0.000, 5.000, 0.2253608767641708 },
    { 0.000, 6.000, 0.3157269774237648 },
    { 0.000, 7.000, 0.3462155161192640 },
    { 0.000, 8.000, 0.5213144983397796 },
    { 0.000, 9.000, 0.5118164314655587 },
    { 0.000, 10.000, 0.2498079464072361 },
    { 1.000, 0.000, 0.5152214519446715 },
    { 1.000, 2.000, 0.5224607465090230 },
    { 1.000, 3.000, 0.5552388244075700 },
    { 1.000, 4.000, 0.6768058778950944 },
    { 1.000, 5.000, 0.2268603341421112 },
    { 1.000, 6.000, 0.4034650325076655 },
    { 1.000, 7.000, 0.6050873699365183 },
    { 1.000, 8.000, 0.4469928074860945 },
    { 1.000, 9.000, 0.5717837225412949 },
    { 1.000, 10.000, 0.6236123771639540 },
    { 2.000, 0.000, 0.4732748430920765 },
    { 2.000, 1.000, 0.4116287773707881 },
    { 2.000, 2.000, 0.6735617255559191 },
    { 2.000, 3.000, 0.4685481223510578 },
    { 2.000, 4.000, 0.5217285147635266 },
    { 2.000, 5.000, 0.3099857621127740 },
    { 2.000, 6.000, 0.5198963790899143 },
    { 2.000, 7.000, 0.5368135755183175 },
    { 2.000, 8.000, 0.5974121243460103 },
    { 2.000, 9.000, 0.5061762819299475 },
    { 2.000, 10.000, 0.4053584629436955 },
    { 3.000, 0.000, 0.6964988417224959 },
    { 3.000, 1.000, 0.2804337898967788 },
    { 3.000, 2.000, 0.5039117034757510 },
    { 3.000, 3.000, 0.1262727547204122 },
    { 3.000, 4.000, 0.5151378431590273 },
    { 3.000, 5.000, 0.3608648557914421 },
    { 3.000, 6.000, 0.4173152281204238 },
    { 3.000, 7.000, 0.3183767212321982 },
    { 3.000, 8.000, 0.6159705261932685 },
    { 3.000, 9.000, 0.2098946778802201 },
    { 3.000, 10.000, 0.6259145677322522 },
    { 4.000, 0.000, 0.6778776474064215 },
    { 4.000, 1.000, 0.5636972558917478 },
    { 4.000, 2.000, 0.5609463461441919 },
    { 4.000, 3.000, 0.3919393079588190 },
    { 4.000, 4.000, 0.4565332026919350 },
    { 4.000, 5.000, 0.4328503980534151 },
    { 4.000, 6.000, 0.6663783448515460 },
    { 4.000, 7.000, 0.5680479590082541 },
    { 4.000, 8.000, 0.4713804449653253 },
    { 4.000, 9.000, 0.4619080887408927 },
    { 4.000, 10.000, 0.2453971502138302 },
    { 5.000, 0.000, 0.3736096939304843 },
    { 5.000, 1.000, 0.6197382619371637 },
    { 5.000, 2.000, 0.2462751913117245 },
    { 5.000, 3.000, 0.5888057655422017 },
    { 5.000, 4.000, 0.5676657743984833 },
    { 5.000, 5.000, 0.5401082500582560 },
    { 5.000, 6.000, 0.5732564409496262 },
    { 5.000, 7.000, 0.5362131939036772 },
    { 5.000, 8.000, 0.5966956639895216 },
    { 5.000, 9.000, 0.7095990309258923 },
    { 5.000, 10.000, 0.6521467766957357 },
    { 6.000, 0.000, 0.2913298482773826 },
    { 6.000, 1.000, 0.5453128289664164 },
    { 6.000, 2.000, 0.5184990051900967 },
    { 6.000, 3.000, 0.4425638609798625 },
    { 6.000, 4.000, 0.6909738992108032 },
    { 6.000, 5.000, 0.5680152265587821 },
    { 6.000, 6.000, 0.5126225439598784 },
    { 6.000, 7.000, 0.5341477866517380 },
    { 6.000, 8.000, 0.6934135599760338 },
    { 6.000, 9.000, 0.5301154807442799 },
    { 6.000, 10.000, 0.5440546177094802 },
    { 7.000, 0.000, 0.5807529715122655 },
    { 7.000, 1.000, 0.2016703092260286 },
    { 7.000, 2.000, 0.3359757455298677 },
    { 7.000, 3.000, 0.1209188626846299 },
    { 7.000, 4.000, 0.4422572403447703 },
    { 7.000, 5.000, 0.1874080511508509 },
    { 7.000, 6.000, 0.3726722557330504 },
    { 7.000, 7.000, 0.4967940848087892 },
    { 7.000, 8.000, 0.5371130944462493 },
    { 7.000, 9.000, 0.3310332131339237 },
    { 7.000, 10.000, 0.4472145652631297 },
    { 8.000, 0.000, 0.6904042010894045 },
    { 8.000, 1.000, 0.4587661686586216 },
    { 8.000, 2.000, 0.5436307809082791 },
    { 8.000, 3.000, 0.5454444729024545 },
    { 8.000, 4.000, 0.4762066185241565 },
    { 8.000, 5.000, 0.4590658758999779 },
    { 8.000, 6.000, 0.2863612712128088 },
    { 8.000, 7.000, 0.2907396355876699 },
    { 8.000, 8.000, 0.7365040505072101 },
    { 8.000, 9.000, 0.3517932391958311 },
    { 8.000, 10.000, 0.5529436419485136 },
    { 9.000, 0.000, 0.7306468691909686 },
    { 9.000, 1.000, 0.7157047707354650 },
    { 9.000, 2.000, 0.4394309112103656 },
    { 9.000, 3.000, 0.3308491398347542 },
    { 9.000, 4.000, 0.5295701368013397 },
    { 9.000, 5.000, 0.2673563046148047 },
    { 9.000, 6.000, 0.5163003812776878 },
    { 9.000, 7.000, 0.5068310855654999 },
    { 9.000, 8.000, 0.3956382245058194 },
    { 9.000, 10.000, 0.3345775581663474 },
    { 10.000, 0.000, 0.3511913699330762 },
    { 10.000, 1.000, 0.4324155964655801 },
    { 10.000, 2.000, 0.6198771046707406 },
    { 10.000, 3.000, 0.4545143844326958 },
    { 10.000, 4.000, 0.7026084109442309 },
    { 10.000, 5.000, 0.4149782466469332 },
    { 10.000, 6.000, 0.1558119867229834 },
    { 10.000, 7.000, 0.6274435873841867 },
    { 10.000, 8.000, 0.4697596208425239 },
    { 10.000, 9.000, 0.4500316646648571 },
    { 10.000, 10.000, 0.4176240554312244 },
    };
    do_test(a, b, c, 16.0712350371314443, false, true);

    a = { 1.000, 1.000 };
    b = { 9.000, 9.000 };
    c = {
    { 0.000, 0.000, 0.6411503633251413 },
    { 0.000, 1.000, 0.1324126559542492 },
    { 0.000, 2.000, 0.3603490686742589 },
    { 0.000, 3.000, 0.3249868966871872 },
    { 0.000, 4.000, 0.2912041798001155 },
    { 0.000, 5.000, 0.4827428569318726 },
    { 0.000, 6.000, 0.3575487390859052 },
    { 0.000, 7.000, 0.4727076107868924 },
    { 0.000, 8.000, 0.4877580920001492 },
    { 0.000, 9.000, 0.5022985807852819 },
    { 0.000, 10.000, 0.2917644287226722 },
    { 1.000, 0.000, 0.2532976132119074 },
    { 1.000, 2.000, 0.2894964966690168 },
    { 1.000, 3.000, 0.4872087204130366 },
    { 1.000, 4.000, 0.2050267104757950 },
    { 1.000, 5.000, 0.7105981229105964 },
    { 1.000, 6.000, 0.3553563235094770 },
    { 1.000, 7.000, 0.4747574116336182 },
    { 1.000, 8.000, 0.1539802624611184 },
    { 1.000, 9.000, 0.5525853380793705 },
    { 1.000, 10.000, 0.3546466640895232 },
    { 2.000, 0.000, 0.3744509277166799 },
    { 2.000, 1.000, 0.4175620906753466 },
    { 2.000, 2.000, 0.8014802994439378 },
    { 2.000, 3.000, 0.2261918382486328 },
    { 2.000, 4.000, 0.2567017614142969 },
    { 2.000, 5.000, 0.3552656891522929 },
    { 2.000, 6.000, 0.4092884410405531 },
    { 2.000, 7.000, 0.3271228980040178 },
    { 2.000, 8.000, 0.3022548944922164 },
    { 2.000, 9.000, 0.3316161376191303 },
    { 2.000, 10.000, 0.1168938284972683 },
    { 3.000, 0.000, 0.4619425689568743 },
    { 3.000, 1.000, 0.6654812547611072 },
    { 3.000, 2.000, 0.4724811366526410 },
    { 3.000, 3.000, 0.1848330848151818 },
    { 3.000, 4.000, 0.3324886291986331 },
    { 3.000, 5.000, 0.4546633606078103 },
    { 3.000, 6.000, 0.3688429803354665 },
    { 3.000, 7.000, 0.2738740036496892 },
    { 3.000, 8.000, 0.4994207257172092 },
    { 3.000, 9.000, 0.2823981530265883 },
    { 3.000, 10.000, 0.3936564664123580 },
    { 4.000, 0.000, 0.3035238500917330 },
    { 4.000, 1.000, 0.3958556283032522 },
    { 4.000, 2.000, 0.6892420151503756 },
    { 4.000, 3.000, 0.3474177439464256 },
    { 4.000, 4.000, 0.3665923489490524 },
    { 4.000, 5.000, 0.2837759209563955 },
    { 4.000, 6.000, 0.2937229792820290 },
    { 4.000, 7.000, 0.5980690984753891 },
    { 4.000, 8.000, 0.3279343605274335 },
    { 4.000, 9.000, 0.6938371307915077 },
    { 4.000, 10.000, 0.3718451214255765 },
    { 5.000, 0.000, 0.5308646746678277 },
    { 5.000, 1.000, 0.4854972439119592 },
    { 5.000, 2.000, 0.5391982944449409 },
    { 5.000, 3.000, 0.2192101433174685 },
    { 5.000, 4.000, 0.3738221364794299 },
    { 5.000, 5.000, 0.6217979077482596 },
    { 5.000, 6.000, 0.3440009619807824 },
    { 5.000, 7.000, 0.4988811419578269 },
    { 5.000, 8.000, 0.3143852648092434 },
    { 5.000, 9.000, 0.3239545485237613 },
    { 5.000, 10.000, 0.3771216382971033 },
    { 6.000, 0.000, 0.7281135666416958 },
    { 6.000, 1.000, 0.5729224926559254 },
    { 6.000, 2.000, 0.6003980763489380 },
    { 6.000, 3.000, 0.7318226620322094 },
    { 6.000, 4.000, 0.6070783634902909 },
    { 6.000, 5.000, 0.5486863777739927 },
    { 6.000, 6.000, 0.3723882282385603 },
    { 6.000, 7.000, 0.3419265219708905 },
    { 6.000, 8.000, 0.3427023074822500 },
    { 6.000, 9.000, 0.4038590128300711 },
    { 6.000, 10.000, 0.4684593688929453 },
    { 7.000, 0.000, 0.4751386109506711 },
    { 7.000, 1.000, 0.6707505219848826 },
    { 7.000, 2.000, 0.5013083730591461 },
    { 7.000, 3.000, 0.5999209789792076 },
    { 7.000, 4.000, 0.3941434172680601 },
    { 7.000, 5.000, 0.4292761857854202 },
    { 7.000, 6.000, 0.5616806014208123 },
    { 7.000, 7.000, 0.4455378309125080 },
    { 7.000, 8.000, 0.6260991535848006 },
    { 7.000, 9.000, 0.7865624276222661 },
    { 7.000, 10.000, 0.2554532312555238 },
    { 8.000, 0.000, 0.2235148521373048 },
    { 8.000, 1.000, 0.3311558233341202 },
    { 8.000, 2.000, 0.1766814082162455 },
    { 8.000, 3.000, 0.6955743464408443 },
    { 8.000, 4.000, 0.1789116759086028 },
    { 8.000, 5.000, 0.3106217246269807 },
    { 8.000, 6.000, 0.4457955898018554 },
    { 8.000, 7.000, 0.4463126790476963 },
    { 8.000, 8.000, 0.0646118795732036 },
    { 8.000, 9.000, 0.5454033916583284 },
    { 8.000, 10.000, 0.4623261931585148 },
    { 9.000, 0.000, 0.5139436444966122 },
    { 9.000, 1.000, 0.7439719103509560 },
    { 9.000, 2.000, 0.5053439736133442 },
    { 9.000, 3.000, 0.3941138421418145 },
    { 9.000, 4.000, 0.2348963142139837 },
    { 9.000, 5.000, 0.5932746986160055 },
    { 9.000, 6.000, 0.4200850510736927 },
    { 9.000, 7.000, 0.4056963957147673 },
    { 9.000, 8.000, 0.6269863257883116 },
    { 9.000, 10.000, 0.5321129586780443 },
    { 10.000, 0.000, 0.3520768899237737 },
    { 10.000, 1.000, 0.4788289674790576 },
    { 10.000, 2.000, 0.4193597306264564 },
    { 10.000, 3.000, 0.7598271770635620 },
    { 10.000, 4.000, 0.6623621327569708 },
    { 10.000, 5.000, 0.4093711327062919 },
    { 10.000, 6.000, 0.1267727791098878 },
    { 10.000, 7.000, 0.3261232882970944 },
    { 10.000, 8.000, 0.4097579277819022 },
    { 10.000, 9.000, 0.3836663228692487 },
    { 10.000, 10.000, 0.5838326432509348 },
    };
    do_test(a, b, c, 13.7274470620482028, false, false);

    a = { 1.000, 1.000 };
    b = { 9.000, 9.000 };
    c = {
    { 0.000, 0.000, 0.6139950381824747 },
    { 0.000, 1.000, 0.5740614952286706 },
    { 0.000, 2.000, 0.2875384076731279 },
    { 0.000, 3.000, 0.5048240768490359 },
    { 0.000, 4.000, 0.4630760345840826 },
    { 0.000, 5.000, 0.2439041312551126 },
    { 0.000, 6.000, 0.5510304645868018 },
    { 0.000, 7.000, 0.4847470131469890 },
    { 0.000, 8.000, 0.5115464857080951 },
    { 0.000, 9.000, 0.7598786493530497 },
    { 0.000, 10.000, 0.5820107358740643 },
    { 1.000, 0.000, 0.3071900999872014 },
    { 1.000, 2.000, 0.5847196258837357 },
    { 1.000, 3.000, 0.5535652592545375 },
    { 1.000, 4.000, 0.5917707731248810 },
    { 1.000, 5.000, 0.2746651724679395 },
    { 1.000, 6.000, 0.5084328288445249 },
    { 1.000, 7.000, 0.4730808833381161 },
    { 1.000, 8.000, 0.4657407692866400 },
    { 1.000, 9.000, 0.3270276630995795 },
    { 1.000, 10.000, 0.1753684085095301 },
    { 2.000, 0.000, 0.8357769105350599 },
    { 2.000, 1.000, 0.2824470781954005 },
    { 2.000, 2.000, 0.7636079494608566 },
    { 2.000, 3.000, 0.2424291072646156 },
    { 2.000, 4.000, 0.3987103877356276 },
    { 2.000, 5.000, 0.3338369216071442 },
    { 2.000, 6.000, 0.4346786393551156 },
    { 2.000, 7.000, 0.4872932717436924 },
    { 2.000, 8.000, 0.3875136486953124 },
    { 2.000, 9.000, 0.4500952837290242 },
    { 2.000, 10.000, 0.4178827934665605 },
    { 3.000, 0.000, 0.5022747161099687 },
    { 3.000, 1.000, 0.3742873804410919 },
    { 3.000, 2.000, 0.3820789932506159 },
    { 3.000, 3.000, 0.3452480855165049 },
    { 3.000, 4.000, 0.3536122728371993 },
    { 3.000, 5.000, 0.5451421271776781 },
    { 3.000, 6.000, 0.4444929928751662 },
    { 3.000, 7.000, 0.1964118999196216 },
    { 3.000, 8.000, 0.1843140309909359 },
    { 3.000, 9.000, 0.4480132316937670 },
    { 3.000, 10.000, 0.5729337963508442 },
    { 4.000, 0.000, 0.4236823669401928 },
    { 4.000, 1.000, 0.5886812620097771 },
    { 4.000, 2.000, 0.3613742142682895 },
    { 4.000, 3.000, 0.2979251330019906 },
    { 4.000, 4.000, 0.6245603353483602 },
    { 4.000, 5.000, 0.3366370329866186 },
    { 4.000, 6.000, 0.4744735890766605 },
    { 4.000, 7.000, 0.4890707797603682 },
    { 4.000, 8.000, 0.4273472825763747 },
    { 4.000, 9.000, 0.1759845074499026 },
    { 4.000, 10.000, 0.4197201180970296 },
    { 5.000, 0.000, 0.3724495806964114 },
    { 5.000, 1.000, 0.4054641623748466 },
    { 5.000, 2.000, 0.5907199336448684 },
    { 5.000, 3.000, 0.6478415025165304 },
    { 5.000, 4.000, 0.5743776540504768 },
    { 5.000, 5.000, 0.3861061899689958 },
    { 5.000, 6.000, 0.4435253203148022 },
    { 5.000, 7.000, 0.0864415116375312 },
    { 5.000, 8.000, 0.5946627867640927 },
    { 5.000, 9.000, 0.7688585647149011 },
    { 5.000, 10.000, 0.5805657999822870 },
    { 6.000, 0.000, 0.5725805492838845 },
    { 6.000, 1.000, 0.2624760165112093 },
    { 6.000, 2.000, 0.3198981302557513 },
    { 6.000, 3.000, 0.4267166797304526 },
    { 6.000, 4.000, 0.5000046577071771 },
    { 6.000, 5.000, 0.4779654012294486 },
    { 6.000, 6.000, 0.5574059721780941 },
    { 6.000, 7.000, 0.3493451794842258 },
    { 6.000, 8.000, 0.4716479589929804 },
    { 6.000, 9.000, 0.1927369761513546 },
    { 6.000, 10.000, 0.5938159531680867 },
    { 7.000, 0.000, 0.2187718577915803 },
    { 7.000, 1.000, 0.3980335339671001 },
    { 7.000, 2.000, 0.5323278983356431 },
    { 7.000, 3.000, 0.3505241856677457 },
    { 7.000, 4.000, 0.3435367251047864 },
    { 7.000, 5.000, 0.3321977386018261 },
    { 7.000, 6.000, 0.4137967786984518 },
    { 7.000, 7.000, 0.2106844420311972 },
    { 7.000, 8.000, 0.3085950445616618 },
    { 7.000, 9.000, 0.6817629579221830 },
    { 7.000, 10.000, 0.5615562015445903 },
    { 8.000, 0.000, 0.3257145021809265 },
    { 8.000, 1.000, 0.6945678202668205 },
    { 8.000, 2.000, 0.5887837974121793 },
    { 8.000, 3.000, 0.2745724315987900 },
    { 8.000, 4.000, 0.5411384387640282 },
    { 8.000, 5.000, 0.5061719730729237 },
    { 8.000, 6.000, 0.6179917119210586 },
    { 8.000, 7.000, 0.8480573085369542 },
    { 8.000, 8.000, 0.5573898398084566 },
    { 8.000, 9.000, 0.3879552038619294 },
    { 8.000, 10.000, 0.4440630720695480 },
    { 9.000, 0.000, 0.6027773290174082 },
    { 9.000, 1.000, 0.3912009688792750 },
    { 9.000, 2.000, 0.2554605443263426 },
    { 9.000, 3.000, 0.3785356681561097 },
    { 9.000, 4.000, 0.5251049162121489 },
    { 9.000, 5.000, 0.4532028627349063 },
    { 9.000, 6.000, 0.5199455952504649 },
    { 9.000, 7.000, 0.7269986515631899 },
    { 9.000, 8.000, 0.3709368768380955 },
    { 9.000, 10.000, 0.1073613664833829 },
    { 10.000, 0.000, 0.6347814522916451 },
    { 10.000, 1.000, 0.3171809136634692 },
    { 10.000, 2.000, 0.6366050456883385 },
    { 10.000, 3.000, 0.3278741062385961 },
    { 10.000, 4.000, 0.5416563192615286 },
    { 10.000, 5.000, 0.1885629022261128 },
    { 10.000, 6.000, 0.4499041176633909 },
    { 10.000, 7.000, 0.3191533992765471 },
    { 10.000, 8.000, 0.2447088089073077 },
    { 10.000, 9.000, 0.5841368753230199 },
    { 10.000, 10.000, 0.4843616673024371 },
    };
    do_test(a, b, c, 14.6928715774053806, false, false);

    a = { 1.000, 1.000 };
    b = { 9.000, 9.000 };
    c = {
    { 0.000, 0.000, 0.6145201016915962 },
    { 0.000, 1.000, 0.3907159311929718 },
    { 0.000, 2.000, 0.2349405927350744 },
    { 0.000, 3.000, 0.3498753558145836 },
    { 0.000, 4.000, 0.4192333935527131 },
    { 0.000, 5.000, 0.2834607690805569 },
    { 0.000, 6.000, 0.1779894448583945 },
    { 0.000, 7.000, 0.4628423256101086 },
    { 0.000, 8.000, 0.5134815015597268 },
    { 0.000, 9.000, 0.4104048418113962 },
    { 0.000, 10.000, 0.6982320191105827 },
    { 1.000, 0.000, 0.2489057823317125 },
    { 1.000, 2.000, 0.3809583591995760 },
    { 1.000, 3.000, 0.5097901556873694 },
    { 1.000, 4.000, 0.5351541038369759 },
    { 1.000, 5.000, 0.5814437643857673 },
    { 1.000, 6.000, 0.5786512044025585 },
    { 1.000, 7.000, 0.5562959423521533 },
    { 1.000, 8.000, 0.1446561297168955 },
    { 1.000, 9.000, 0.5089250999735668 },
    { 1.000, 10.000, 0.2134641146985814 },
    { 2.000, 0.000, 0.4933750845724716 },
    { 2.000, 1.000, 0.7568290486698970 },
    { 2.000, 2.000, 0.6742575516225769 },
    { 2.000, 3.000, 0.5413024798734113 },
    { 2.000, 4.000, 0.3903952295193449 },
    { 2.000, 5.000, 0.1202536502620205 },
    { 2.000, 6.000, 0.7792531482176855 },
    { 2.000, 7.000, 0.3542434121249243 },
    { 2.000, 8.000, 0.4527095895493403 },
    { 2.000, 9.000, 0.6734483156120404 },
    { 2.000, 10.000, 0.4973357045324519 },
    { 3.000, 0.000, 0.4714170937193558 },
    { 3.000, 1.000, 0.1627824304858222 },
    { 3.000, 2.000, 0.7340902087977156 },
    { 3.000, 3.000, 0.4876155282603576 },
    { 3.000, 4.000, 0.5992240621475503 },
    { 3.000, 5.000, 0.7804942474002018 },
    { 3.000, 6.000, 0.6466349057620391 },
    { 3.000, 7.000, 0.6134563145460561 },
    { 3.000, 8.000, 0.4765134327812120 },
    { 3.000, 9.000, 0.5807516278931871 },
    { 3.000, 10.000, 0.4789594607194885 },
    { 4.000, 0.000, 0.4186592280166224 },
    { 4.000, 1.000, 0.5703470590291545 },
    { 4.000, 2.000, 0.5565268028760328 },
    { 4.000, 3.000, 0.8086539100622758 },
    { 4.000, 4.000, 0.1643891723128036 },
    { 4.000, 5.000, 0.4379746299935505 },
    { 4.000, 6.000, 0.6654518848517910 },
    { 4.000, 7.000, 0.2895862137665972 },
    { 4.000, 8.000, 0.5799682471202686 },
    { 4.000, 9.000, 0.2206447056261822 },
    { 4.000, 10.000, 0.4480927936965600 },
    { 5.000, 0.000, 0.6393656342988834 },
    { 5.000, 1.000, 0.2306613927008584 },
    { 5.000, 2.000, 0.0848766893846914 },
    { 5.000, 3.000, 0.2960278699407354 },
    { 5.000, 4.000, 0.4383295530220493 },
    { 5.000, 5.000, 0.3555792219238356 },
    { 5.000, 6.000, 0.3768187383888289 },
    { 5.000, 7.000, 0.3978561755502596 },
    { 5.000, 8.000, 0.0806787241017446 },
    { 5.000, 9.000, 0.4788230397971347 },
    { 5.000, 10.000, 0.6053166110767051 },
    { 6.000, 0.000, 0.5412604822078719 },
    { 6.000, 1.000, 0.4683859659126028 },
    { 6.000, 2.000, 0.3469970504986122 },
    { 6.000, 3.000, 0.3193184523610398 },
    { 6.000, 4.000, 0.7992499470943585 },
    { 6.000, 5.000, 0.6885032899444923 },
    { 6.000, 6.000, 0.4962127519072965 },
    { 6.000, 7.000, 0.5952405162854120 },
    { 6.000, 8.000, 0.5787074761698022 },
    { 6.000, 9.000, 0.6644924672087654 },
    { 6.000, 10.000, 0.2017105176346377 },
    { 7.000, 0.000, 0.1999188261805102 },
    { 7.000, 1.000, 0.2593667749548331 },
    { 7.000, 2.000, 0.2222040321445093 },
    { 7.000, 3.000, 0.4132233665557578 },
    { 7.000, 4.000, 0.4447717723203823 },
    { 7.000, 5.000, 0.5013440868118778 },
    { 7.000, 6.000, 0.2611297240247950 },
    { 7.000, 7.000, 0.5292079198407009 },
    { 7.000, 8.000, 0.4967986470786854 },
    { 7.000, 9.000, 0.4493496187264099 },
    { 7.000, 10.000, 0.4715533658629283 },
    { 8.000, 0.000, 0.5130675454856828 },
    { 8.000, 1.000, 0.1620391175849363 },
    { 8.000, 2.000, 0.4117036545882001 },
    { 8.000, 3.000, 0.1882251808186993 },
    { 8.000, 4.000, 0.5044926903443411 },
    { 8.000, 5.000, 0.3071186358807608 },
    { 8.000, 6.000, 0.6422823559725657 },
    { 8.000, 7.000, 0.4211845461046323 },
    { 8.000, 8.000, 0.4290433996589854 },
    { 8.000, 9.000, 0.5345047865761444 },
    { 8.000, 10.000, 0.3035182504216209 },
    { 9.000, 0.000, 0.4543561843922361 },
    { 9.000, 1.000, 0.7590990240918473 },
    { 9.000, 2.000, 0.4770995720056816 },
    { 9.000, 3.000, 0.5385804072255268 },
    { 9.000, 4.000, 0.2525447927182540 },
    { 9.000, 5.000, 0.6293001142563298 },
    { 9.000, 6.000, 0.4277926348848268 },
    { 9.000, 7.000, 0.1308593007037416 },
    { 9.000, 8.000, 0.5674531088909134 },
    { 9.000, 10.000, 0.4596075027482584 },
    { 10.000, 0.000, 0.4696004184661433 },
    { 10.000, 1.000, 0.5788813609862700 },
    { 10.000, 2.000, 0.2833484153961763 },
    { 10.000, 3.000, 0.4891035736771300 },
    { 10.000, 4.000, 0.7220162641955540 },
    { 10.000, 5.000, 0.3647782122949138 },
    { 10.000, 6.000, 0.5930024808039889 },
    { 10.000, 7.000, 0.5736607196973637 },
    { 10.000, 8.000, 0.3691964468685910 },
    { 10.000, 9.000, 0.3444355987245217 },
    { 10.000, 10.000, 0.2445299386745319 },
    };
    do_test(a, b, c, 14.9867218251038761, false, false);

    a = { 1.000, 1.000 };
    b = { 9.000, 9.000 };
    c = {
    { 0.000, 0.000, 0.7506019865395501 },
    { 0.000, 1.000, 0.4856071472866461 },
    { 0.000, 2.000, 0.3374469975242391 },
    { 0.000, 3.000, 0.4497501039644703 },
    { 0.000, 4.000, 0.4234789050417021 },
    { 0.000, 5.000, 0.2247573624132201 },
    { 0.000, 6.000, 0.4449969198787585 },
    { 0.000, 7.000, 0.3946972269332036 },
    { 0.000, 8.000, 0.4700915106805041 },
    { 0.000, 9.000, 0.3866427530301735 },
    { 0.000, 10.000, 0.6737988991895690 },
    { 1.000, 0.000, 0.4429041845491156 },
    { 1.000, 2.000, 0.4268755506025627 },
    { 1.000, 3.000, 0.3295254288939759 },
    { 1.000, 4.000, 0.3942131668562069 },
    { 1.000, 5.000, 0.5720846093958244 },
    { 1.000, 6.000, 0.4527818781556561 },
    { 1.000, 7.000, 0.4416746713919565 },
    { 1.000, 8.000, 0.2106690155575052 },
    { 1.000, 9.000, 0.3348384560784325 },
    { 1.000, 10.000, 0.5257730349199846 },
    { 2.000, 0.000, 0.6386935936985537 },
    { 2.000, 1.000, 0.5725168500328436 },
    { 2.000, 2.000, 0.4840060051297769 },
    { 2.000, 3.000, 0.5750620202394202 },
    { 2.000, 4.000, 0.5020567384315654 },
    { 2.000, 5.000, 0.3034349253633991 },
    { 2.000, 6.000, 0.2532953044166789 },
    { 2.000, 7.000, 0.6022182482527568 },
    { 2.000, 8.000, 0.5244836128083988 },
    { 2.000, 9.000, 0.4775157727533951 },
    { 2.000, 10.000, 0.3338080480461940 },
    { 3.000, 0.000, 0.2942656924249604 },
    { 3.000, 1.000, 0.1777731613023207 },
    { 3.000, 2.000, 0.3201573128113523 },
    { 3.000, 3.000, 0.4370888927718624 },
    { 3.000, 4.000, 0.4818982175784186 },
    { 3.000, 5.000, 0.3687241757987067 },
    { 3.000, 6.000, 0.4618836563313380 },
    { 3.000, 7.000, 0.5853232118999585 },
    { 3.000, 8.000, 0.5459370994241908 },
    { 3.000, 9.000, 0.2987666432512924 },
    { 3.000, 10.000, 0.5232205925742164 },
    { 4.000, 0.000, 0.4193082866957411 },
    { 4.000, 1.000, 0.4251557315932586 },
    { 4.000, 2.000, 0.4929290308384224 },
    { 4.000, 3.000, 0.6587507650488987 },
    { 4.000, 4.000, 0.2648229352897033 },
    { 4.000, 5.000, 0.4285965201677754 },
    { 4.000, 6.000, 0.5137665086193010 },
    { 4.000, 7.000, 0.3384735347935930 },
    { 4.000, 8.000, 0.3480205790838227 },
    { 4.000, 9.000, 0.3055049657123163 },
    { 4.000, 10.000, 0.4258751096902415 },
    { 5.000, 0.000, 0.6945945311570539 },
    { 5.000, 1.000, 0.7004707466578111 },
    { 5.000, 2.000, 0.3760059328051284 },
    { 5.000, 3.000, 0.5266168278409168 },
    { 5.000, 4.000, 0.4118698900798335 },
    { 5.000, 5.000, 0.2444740151753649 },
    { 5.000, 6.000, 0.4756471070693806 },
    { 5.000, 7.000, 0.3086806527106091 },
    { 5.000, 8.000, 0.4896301798755303 },
    { 5.000, 9.000, 0.5992753892904147 },
    { 5.000, 10.000, 0.4169346397044137 },
    { 6.000, 0.000, 0.4701045424444601 },
    { 6.000, 1.000, 0.3536090145120397 },
    { 6.000, 2.000, 0.1988011175533757 },
    { 6.000, 3.000, 0.4209859795169905 },
    { 6.000, 4.000, 0.5373833338497206 },
    { 6.000, 5.000, 0.3457013543928042 },
    { 6.000, 6.000, 0.4615439463173970 },
    { 6.000, 7.000, 0.4224248924525454 },
    { 6.000, 8.000, 0.4172875900520012 },
    { 6.000, 9.000, 0.5697764946380630 },
    { 6.000, 10.000, 0.3032218111446127 },
    { 7.000, 0.000, 0.6006436686264350 },
    { 7.000, 1.000, 0.5430183856515214 },
    { 7.000, 2.000, 0.6216707408661023 },
    { 7.000, 3.000, 0.4328349657123908 },
    { 7.000, 4.000, 0.5405575168551877 },
    { 7.000, 5.000, 0.5303230293793604 },
    { 7.000, 6.000, 0.0814847724745050 },
    { 7.000, 7.000, 0.3227465482195839 },
    { 7.000, 8.000, 0.2759761466877535 },
    { 7.000, 9.000, 0.3091967242537066 },
    { 7.000, 10.000, 0.3963106934214011 },
    { 8.000, 0.000, 0.2934115852927789 },
    { 8.000, 1.000, 0.6187175379367545 },
    { 8.000, 2.000, 0.3467951652361080 },
    { 8.000, 3.000, 0.2315137705067173 },
    { 8.000, 4.000, 0.6033794333925471 },
    { 8.000, 5.000, 0.3265888977097347 },
    { 8.000, 6.000, 0.4271830743877217 },
    { 8.000, 7.000, 0.2186938591534272 },
    { 8.000, 8.000, 0.3851946577196941 },
    { 8.000, 9.000, 0.4133598049404100 },
    { 8.000, 10.000, 0.2035436735255644 },
    { 9.000, 0.000, 0.4784515166888013 },
    { 9.000, 1.000, 0.6178213486215099 },
    { 9.000, 2.000, 0.5538525424199179 },
    { 9.000, 3.000, 0.3884740943787620 },
    { 9.000, 4.000, 0.5460838031256571 },
    { 9.000, 5.000, 0.4762158754980191 },
    { 9.000, 6.000, 0.5872746163280681 },
    { 9.000, 7.000, 0.5979917262447998 },
    { 9.000, 8.000, 0.6783347694436088 },
    { 9.000, 10.000, 0.5486730782082304 },
    { 10.000, 0.000, 0.4719184632645920 },
    { 10.000, 1.000, 0.5148765011457727 },
    { 10.000, 2.000, 0.3693256333703175 },
    { 10.000, 3.000, 0.4625708959763870 },
    { 10.000, 4.000, 0.2943533447803929 },
    { 10.000, 5.000, 0.6869741164846346 },
    { 10.000, 6.000, 0.2537896426627412 },
    { 10.000, 7.000, 0.5091384337982162 },
    { 10.000, 8.000, 0.2862344294087961 },
    { 10.000, 9.000, 0.3260851952014491 },
    { 10.000, 10.000, 0.5257366258883849 },
    };
    do_test(a, b, c, 12.4933669421340792, false, false);

    a = { 1.000, 1.000 };
    b = { 9.000, 9.000 };
    c = {
    { 0.000, 0.000, 0.2078724663471803 },
    { 0.000, 1.000, 0.3518540621967986 },
    { 0.000, 2.000, 0.7230653834296390 },
    { 0.000, 3.000, 0.2506722307065501 },
    { 0.000, 4.000, 0.1012273793807253 },
    { 0.000, 5.000, 0.5595602217363194 },
    { 0.000, 6.000, 0.2447613856522366 },
    { 0.000, 7.000, 0.2994968496495858 },
    { 0.000, 8.000, 0.3202035486465320 },
    { 0.000, 9.000, 0.6001671646954492 },
    { 0.000, 10.000, 0.6284079373581335 },
    { 1.000, 0.000, 0.4822092334041372 },
    { 1.000, 2.000, 0.4114591562887653 },
    { 1.000, 3.000, 0.5654832578497008 },
    { 1.000, 4.000, 0.3391107151983306 },
    { 1.000, 5.000, 0.2095397915923968 },
    { 1.000, 6.000, 0.5665704447543248 },
    { 1.000, 7.000, 0.4500809976132586 },
    { 1.000, 8.000, 0.4060401846421882 },
    { 1.000, 9.000, 0.4606385810533538 },
    { 1.000, 10.000, 0.3440654081990942 },
    { 2.000, 0.000, 0.4294342170702293 },
    { 2.000, 1.000, 0.3029613851336762 },
    { 2.000, 2.000, 0.4849429816240445 },
    { 2.000, 3.000, 0.4248559213941916 },
    { 2.000, 4.000, 0.5175474805058912 },
    { 2.000, 5.000, 0.2887246527476236 },
    { 2.000, 6.000, 0.5163500594208017 },
    { 2.000, 7.000, 0.4916933061322197 },
    { 2.000, 8.000, 0.4572026654379442 },
    { 2.000, 9.000, 0.3733422803459689 },
    { 2.000, 10.000, 0.3278186176205054 },
    { 3.000, 0.000, 0.2732723351335153 },
    { 3.000, 1.000, 0.5459477321477607 },
    { 3.000, 2.000, 0.6252761152340099 },
    { 3.000, 3.000, 0.4045259347418323 },
    { 3.000, 4.000, 0.7436086734523997 },
    { 3.000, 5.000, 0.3509526807116344 },
    { 3.000, 6.000, 0.4855610943166539 },
    { 3.000, 7.000, 0.6637041904265061 },
    { 3.000, 8.000, 0.8173147573834285 },
    { 3.000, 9.000, 0.5158576955320313 },
    { 3.000, 10.000, 0.3043897167546675 },
    { 4.000, 0.000, 0.7992815787205473 },
    { 4.000, 1.000, 0.3313991108676418 },
    { 4.000, 2.000, 0.4127384773688391 },
    { 4.000, 3.000, 0.3657824541209265 },
    { 4.000, 4.000, 0.4794531088555232 },
    { 4.000, 5.000, 0.1542140993988141 },
    { 4.000, 6.000, 0.4423137628706172 },
    { 4.000, 7.000, 0.3159690980566666 },
    { 4.000, 8.000, 0.4753060935297981 },
    { 4.000, 9.000, 0.6121771214297042 },
    { 4.000, 10.000, 0.5355200316058472 },
    { 5.000, 0.000, 0.5611060454277321 },
    { 5.000, 1.000, 0.2486253246897832 },
    { 5.000, 2.000, 0.4748902372783050 },
    { 5.000, 3.000, 0.3595784005941823 },
    { 5.000, 4.000, 0.7499545209808275 },
    { 5.000, 5.000, 0.5770029368111863 },
    { 5.000, 6.000, 0.3892832355340943 },
    { 5.000, 7.000, 0.2816787063376978 },
    { 5.000, 8.000, 0.5071447374997661 },
    { 5.000, 9.000, 0.4443779576802626 },
    { 5.000, 10.000, 0.7034051369642839 },
    { 6.000, 0.000, 0.4934057743521407 },
    { 6.000, 1.000, 0.8326509934617207 },
    { 6.000, 2.000, 0.3751305466750637 },
    { 6.000, 3.000, 0.2704891359200701 },
    { 6.000, 4.000, 0.3490328761981800 },
    { 6.000, 5.000, 0.5331027081934735 },
    { 6.000, 6.000, 0.5398559205466881 },
    { 6.000, 7.000, 0.2739159792428836 },
    { 6.000, 8.000, 0.7208073740126565 },
    { 6.000, 9.000, 0.5005563945276662 },
    { 6.000, 10.000, 0.7109429667005315 },
    { 7.000, 0.000, 0.4637007826706394 },
    { 7.000, 1.000, 0.3243535525398329 },
    { 7.000, 2.000, 0.3043535689590499 },
    { 7.000, 3.000, 0.5960825439775362 },
    { 7.000, 4.000, 0.5451282847439870 },
    { 7.000, 5.000, 0.5173176386626437 },
    { 7.000, 6.000, 0.5116895993007347 },
    { 7.000, 7.000, 0.4278304709354415 },
    { 7.000, 8.000, 0.4101615382125601 },
    { 7.000, 9.000, 0.5243800084339455 },
    { 7.000, 10.000, 0.6025184898404404 },
    { 8.000, 0.000, 0.3373502016300335 },
    { 8.000, 1.000, 0.2522490389412269 },
    { 8.000, 2.000, 0.5917595816077664 },
    { 8.000, 3.000, 0.4944186039967462 },
    { 8.000, 4.000, 0.4904601888963953 },
    { 8.000, 5.000, 0.5551552923163399 },
    { 8.000, 6.000, 0.1243354036705568 },
    { 8.000, 7.000, 0.6430443244753405 },
    { 8.000, 8.000, 0.5141109351301566 },
    { 8.000, 9.000, 0.2964398171519860 },
    { 8.000, 10.000, 0.5085104153724387 },
    { 9.000, 0.000, 0.3337886509252712 },
    { 9.000, 1.000, 0.4914167305687442 },
    { 9.000, 2.000, 0.5562095870962366 },
    { 9.000, 3.000, 0.5739424097584560 },
    { 9.000, 4.000, 0.2302817350951955 },
    { 9.000, 5.000, 0.2533670790726319 },
    { 9.000, 6.000, 0.1717699095373973 },
    { 9.000, 7.000, 0.3972671766998246 },
    { 9.000, 8.000, 0.3953503534896299 },
    { 9.000, 10.000, 0.4453428114065900 },
    { 10.000, 0.000, 0.5287987420102581 },
    { 10.000, 1.000, 0.2009388349251822 },
    { 10.000, 2.000, 0.7500633175252005 },
    { 10.000, 3.000, 0.2965618860209361 },
    { 10.000, 4.000, 0.4296694461023435 },
    { 10.000, 5.000, 0.7503123515518382 },
    { 10.000, 6.000, 0.2864878211868927 },
    { 10.000, 7.000, 0.3705798773327842 },
    { 10.000, 8.000, 0.5295469788601622 },
    { 10.000, 9.000, 0.7020932491170242 },
    { 10.000, 10.000, 0.4997817261843011 },
    };
    do_test(a, b, c, 12.5489526202618347, false, false);

    a = { 1.000, 1.000 };
    b = { 9.000, 9.000 };
    c = {
    { 0.000, 0.000, 0.4249701515072957 },
    { 0.000, 1.000, 0.6808825216954574 },
    { 0.000, 2.000, 0.3072795001091436 },
    { 0.000, 3.000, 0.6552467846078798 },
    { 0.000, 4.000, 0.3583087297389284 },
    { 0.000, 5.000, 0.6769315467914566 },
    { 0.000, 6.000, 0.6217206089990214 },
    { 0.000, 7.000, 0.5559677990851923 },
    { 0.000, 8.000, 0.6725888390326872 },
    { 0.000, 9.000, 0.3349203210091218 },
    { 0.000, 10.000, 0.4274188817711547 },
    { 1.000, 0.000, 0.5266627204371616 },
    { 1.000, 2.000, 0.5291901504853740 },
    { 1.000, 3.000, 0.4094858472933993 },
    { 1.000, 4.000, 0.4176978829549625 },
    { 1.000, 5.000, 0.4793686828343198 },
    { 1.000, 6.000, 0.3265277050668374 },
    { 1.000, 7.000, 0.2770142435794696 },
    { 1.000, 8.000, 0.6493630801560357 },
    { 1.000, 9.000, 0.3765889764530584 },
    { 1.000, 10.000, 0.2775055269012228 },
    { 2.000, 0.000, 0.4815025591989979 },
    { 2.000, 1.000, 0.2149796760873869 },
    { 2.000, 2.000, 0.6575259576318785 },
    { 2.000, 3.000, 0.4148999240482226 },
    { 2.000, 4.000, 0.3825690287863835 },
    { 2.000, 5.000, 0.4383926281007007 },
    { 2.000, 6.000, 0.4430248965276405 },
    { 2.000, 7.000, 0.4027974767843261 },
    { 2.000, 8.000, 0.4962367636850104 },
    { 2.000, 9.000, 0.4466138552175835 },
    { 2.000, 10.000, 0.4848537622718140 },
    { 3.000, 0.000, 0.3822127133840695 },
    { 3.000, 1.000, 0.3691158808534965 },
    { 3.000, 2.000, 0.5212016326608137 },
    { 3.000, 3.000, 0.5749439456267282 },
    { 3.000, 4.000, 0.3290104734012857 },
    { 3.000, 5.000, 0.6766090692719444 },
    { 3.000, 6.000, 0.5822571738855913 },
    { 3.000, 7.000, 0.4802169191418215 },
    { 3.000, 8.000, 0.3522579584503546 },
    { 3.000, 9.000, 0.3857655938481912 },
    { 3.000, 10.000, 0.5081634001107886 },
    { 4.000, 0.000, 0.4186218348098918 },
    { 4.000, 1.000, 0.3111314704874530 },
    { 4.000, 2.000, 0.3734087368240580 },
    { 4.000, 3.000, 0.7441908973501995 },
    { 4.000, 4.000, 0.5420090592233464 },
    { 4.000, 5.000, 0.2785028375918046 },
    { 4.000, 6.000, 0.4401616766816005 },
    { 4.000, 7.000, 0.6030960609437898 },
    { 4.000, 8.000, 0.5414646462304518 },
    { 4.000, 9.000, 0.2293305272469297 },
    { 4.000, 10.000, 0.5109968045493588 },
    { 5.000, 0.000, 0.5108364275889471 },
    { 5.000, 1.000, 0.3407307470915839 },
    { 5.000, 2.000, 0.4819804471218958 },
    { 5.000, 3.000, 0.4629334781086072 },
    { 5.000, 4.000, 0.5005281948717311 },
    { 5.000, 5.000, 0.5933369581354782 },
    { 5.000, 6.000, 0.6706014333525673 },
    { 5.000, 7.000, 0.3705092129996047 },
    { 5.000, 8.000, 0.3077709282981232 },
    { 5.000, 9.000, 0.3490676059154794 },
    { 5.000, 10.000, 0.5766804263228550 },
    { 6.000, 0.000, 0.4096493117278442 },
    { 6.000, 1.000, 0.5704644558252766 },
    { 6.000, 2.000, 0.5053899698657914 },
    { 6.000, 3.000, 0.5979023339459673 },
    { 6.000, 4.000, 0.4105599300703034 },
    { 6.000, 5.000, 0.2862429498927668 },
    { 6.000, 6.000, 0.5094684424577280 },
    { 6.000, 7.000, 0.3824395824456587 },
    { 6.000, 8.000, 0.1002695809816942 },
    { 6.000, 9.000, 0.5306511969538406 },
    { 6.000, 10.000, 0.5263896268559619 },
    { 7.000, 0.000, 0.6067963546374813 },
    { 7.000, 1.000, 0.6254440760007128 },
    { 7.000, 2.000, 0.5891880545066669 },
    { 7.000, 3.000, 0.4392233720747754 },
    { 7.000, 4.000, 0.7253325157100334 },
    { 7.000, 5.000, 0.5960999041562900 },
    { 7.000, 6.000, 0.4063420956255868 },
    { 7.000, 7.000, 0.3965447456343099 },
    { 7.000, 8.000, 0.3695922265062109 },
    { 7.000, 9.000, 0.4408410483738407 },
    { 7.000, 10.000, 0.6047444409923628 },
    { 8.000, 0.000, 0.5730419437168166 },
    { 8.000, 1.000, 0.5255622443044558 },
    { 8.000, 2.000, 0.5142442393815144 },
    { 8.000, 3.000, 0.1775637784274295 },
    { 8.000, 4.000, 0.3588351388229057 },
    { 8.000, 5.000, 0.4669849111000076 },
    { 8.000, 6.000, 0.4470176471164450 },
    { 8.000, 7.000, 0.8072685699211434 },
    { 8.000, 8.000, 0.6431312649277970 },
    { 8.000, 9.000, 0.3728508293861523 },
    { 8.000, 10.000, 0.4795580096310004 },
    { 9.000, 0.000, 0.5138814461650326 },
    { 9.000, 1.000, 0.4078397401375696 },
    { 9.000, 2.000, 0.5071962254354730 },
    { 9.000, 3.000, 0.5695311994990334 },
    { 9.000, 4.000, 0.2858507885830477 },
    { 9.000, 5.000, 0.5967741268454120 },
    { 9.000, 6.000, 0.2893300000810995 },
    { 9.000, 7.000, 0.4141012277221307 },
    { 9.000, 8.000, 0.3966644988628104 },
    { 9.000, 10.000, 0.4760647293878719 },
    { 10.000, 0.000, 0.4326154669979587 },
    { 10.000, 1.000, 0.3774326851358637 },
    { 10.000, 2.000, 0.4603309559868649 },
    { 10.000, 3.000, 0.3514071292011067 },
    { 10.000, 4.000, 0.0799317784840241 },
    { 10.000, 5.000, 0.4640916213160380 },
    { 10.000, 6.000, 0.6288521607639268 },
    { 10.000, 7.000, 0.3577716574771330 },
    { 10.000, 8.000, 0.5139400387415662 },
    { 10.000, 9.000, 0.6289698609849438 },
    { 10.000, 10.000, 0.5848140678601339 },
    };
    do_test(a, b, c, 14.7467411387926965, false, false);

    a = {1, 1};
    b = {9, 9};
    c = {
    {0, 0, 0.386676},
    {0, 1, 0.615209},
    {0, 2, 0.201473},
    {0, 3, 0.604771},
    {0, 4, 0.363905},
    {0, 5, 0.636979},
    {0, 6, 0.546391},
    {0, 7, 0.247182},
    {0, 8, 0.219593},
    {0, 9, 0.682587},
    {0, 10, 0.239959},
    {1, 0, 0.530382},
    {1, 2, 0.325125},
    {1, 3, 0.58301},
    {1, 4, 0.191919},
    {1, 5, 0.437714},
    {1, 6, 0.359611},
    {1, 7, 0.729585},
    {1, 8, 0.344332},
    {1, 9, 0.476069},
    {1, 10, 0.7766},
    {2, 0, 0.503661},
    {2, 1, 0.250298},
    {2, 2, 0.471848},
    {2, 3, 0.645592},
    {2, 4, 0.442771},
    {2, 5, 0.447798},
    {2, 6, 0.105008},
    {2, 7, 0.596491},
    {2, 8, 0.483956},
    {2, 9, 0.531778},
    {2, 10, 0.296814},
    {3, 0, 0.245096},
    {3, 1, 0.574863},
    {3, 2, 0.477596},
    {3, 3, 0.416936},
    {3, 4, 0.627791},
    {3, 5, 0.493234},
    {3, 6, 0.518963},
    {3, 7, 0.525499},
    {3, 8, 0.123523},
    {3, 9, 0.365432},
    {3, 10, 0.433508},
    {4, 0, 0.315726},
    {4, 1, 0.391217},
    {4, 2, 0.2246},
    {4, 3, 0.439071},
    {4, 4, 0.372784},
    {4, 5, 0.300751},
    {4, 6, 0.399105},
    {4, 7, 0.65388},
    {4, 8, 0.414471},
    {4, 9, 0.385597},
    {4, 10, 0.171878},
    {5, 0, 0.423704},
    {5, 1, 0.429366},
    {5, 2, 0.595281},
    {5, 3, 0.40127},
    {5, 4, 0.469136},
    {5, 5, 0.278056},
    {5, 6, 0.675763},
    {5, 7, 0.344067},
    {5, 8, 0.456111},
    {5, 9, 0.673087},
    {5, 10, 0.355875},
    {6, 0, 0.371274},
    {6, 1, 0.342792},
    {6, 2, 0.503237},
    {6, 3, 0.567941},
    {6, 4, 0.217292},
    {6, 5, 0.505954},
    {6, 6, 0.617764},
    {6, 7, 0.480696},
    {6, 8, 0.253131},
    {6, 9, 0.599974},
    {6, 10, 0.636225},
    {7, 0, 0.272641},
    {7, 1, 0.524258},
    {7, 2, 0.251576},
    {7, 3, 0.0995181},
    {7, 4, 0.523949},
    {7, 5, 0.543726},
    {7, 6, 0.343432},
    {7, 7, 0.427756},
    {7, 8, 0.35505},
    {7, 9, 0.281201},
    {7, 10, 0.489763},
    {8, 0, 0.400598},
    {8, 1, 0.490023},
    {8, 2, 0.538512},
    {8, 3, 0.157055},
    {8, 4, 0.525674},
    {8, 5, 0.772919},
    {8, 6, 0.452346},
    {8, 7, 0.533014},
    {8, 8, 0.610712},
    {8, 9, 0.715131},
    {8, 10, 0.51472},
    {9, 0, 0.49689},
    {9, 1, 0.505009},
    {9, 2, 0.401956},
    {9, 3, 0.751853},
    {9, 4, 0.5943},
    {9, 5, 0.325856},
    {9, 6, 0.73645},
    {9, 7, 0.652057},
    {9, 8, 0.569655},
    {9, 10, 0.835554},
    {10, 0, 0.348718},
    {10, 1, 0.383278},
    {10, 2, 0.459339},
    {10, 3, 0.284639},
    {10, 4, 0.448761},
    {10, 5, 0.290912},
    {10, 6, 0.398753},
    {10, 7, 0.386942},
    {10, 8, 0.550997},
    {10, 9, 0.316519},
    {10, 10, 0.746351},
    };
    do_test(a, b, c, 17.617687795459, false, true);
                                 // we want each test to take ~120 ms
    qDebug() << timer.elapsed(); // so this timer should read ~1000 ms when we're done optimising
}
